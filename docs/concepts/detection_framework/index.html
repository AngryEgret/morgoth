<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Detection framework - Morgoth - Documentation - Morgoth - Documentation</title>
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">

  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script>
  <script src="../../js/theme.js"></script>

  <style>
    body {font-size: 90%;}
    pre, code {font-size: 100%;}
    h3, h4, h5, h6 {color: #2980b9; font-weight: 300}
  </style> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon-home"></a>
        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
      <ul class="current">
    
        
        <span>Overview</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../overview/overview">Overview</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../overview/getting-started">Getting started</a>
                    
                </li>
            
        

    
        
        <span>Configuration</span>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../configuration/configuration">Configuration</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../configuration/engine">Engine</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../configuration/schedules">Schedules</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../configuration/mappings">Mappings</a>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../../configuration/alerts">Alerts</a>
                    
                </li>
            
        

    
        
        <span>Concepts</span>
            
                <li class="toctree-l1 current">
                    <a class="current" href=".">Detection framework</a>
                    
                        <ul>
                        
                            <li class="toctree-l2"><a href="#detection-framework">Detection Framework</a></li>
                            
                                <li><a class="toctree-l3" href="#lossy-counting">Lossy Counting</a></li>
                            
                                <li><a class="toctree-l3" href="#what-is-considered-anomalous">What is considered anomalous?</a></li>
                            
                                <li><a class="toctree-l3" href="#putting-it-all-together">Putting it all together</a></li>
                            
                        
                        </ul>
                    
                </li>
            
                <li class="toctree-l1 ">
                    <a class="" href="../fingerprints">Fingerprints</a>
                    
                </li>
            
        

    
</ul>

      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Morgoth - Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    <li>Detection framework</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="https://github.com/nathanielc/morgoth/" class="icon icon-github"> Edit on GitHub</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              <h1 id="detection-framework">Detection Framework</h1>
<p>There are two basic components to the detection framework Morgoth employs.</p>
<ol>
<li>A Lossy Counting strategy for finding anomlous behavior.</li>
<li>A fingerprinting mechanism to summarize/fingperprint behaviors.</li>
</ol>
<p>At a high level Morgoth fingperprints each window of data it sees and keeps track of which fingperprints it has seen before and marks new/infrequent fingperprints as anomalous.
The power of the framework is in which fingerprinting algorithms are used and in the simplicity of configuring how to count frequent fingperprints.</p>
<h2 id="lossy-counting">Lossy Counting</h2>
<p>The <a href="http://www.vldb.org/conf/2002/S10P03.pdf">Lossy Counting algorithm</a> is a way of counting frequent items efficiently.
The algorithm is lossy since it will drop infrequent items but does so in such a way that it can guarantee certain behaviors:</p>
<ol>
<li>There are no false negatives. The frequency of an item cannot be over estimated.</li>
<li>False positives are guaranteed to have a frequency of at least <code>sN-eN</code>, where <code>N</code> is the number of items processed, <code>s</code> is the minimum support and <code>e</code> is the error tolerance.</li>
<li>The frequency of an item can be underestimated by at most <code>eN</code>.</li>
<li>The space requirements of the algorithm are <code>1/e log(eN)</code>.</li>
</ol>
<p>These constraints allow the user to have intuitive control over what is considered an anomaly.
For example <code>#3</code> states that items can be underestimated by at most <code>eN</code>.
What this means given an <code>e=0.10</code>, items that are less than 10% frequent could be underestimated to have 0% frequency as a worst case.
As result these items would get dropped from the algorithm and when they occur again will be marked as anomalies.
By settings the error tolerance and minimum support one can control how lossy the counting alogorithm is for a given use case.</p>
<h2 id="what-is-considered-anomalous">What is considered anomalous?</h2>
<p>The answer is simple; everytime the Lossy Counting algorithm is given an fingperprint is checks to see how many times it has seen that fingperprint.
If the fingperprint has been counted less than a given <code>normal count</code> than it is considered anomalous.</p>
<h3 id="consensus-model">Consensus Model</h3>
<p>Each detector instance can have more than one fingperprinting algorithm.
In this case the detector will mark the window as anomalous only of the percentage of fingperprinters that agree is greater than a <code>consensus</code> threshold.</p>
<h2 id="putting-it-all-together">Putting it all together</h2>
<p>Each detector instance has five parameters:</p>
<ol>
<li><code>Normal Count</code> -- How many times a window must be seen before it is considered normal, aka no longer anomalous.</li>
<li><code>Error Tolerance</code> -- Controls the maximum error that will be tolerated while counting fingperprints.</li>
<li><code>Minimum Support</code> -- The minimum frequency a fingperprint must have in order to be considered frequent.</li>
<li><code>Consensus</code> -- The percentage of fingperprinters that must agree in order to mark a window as anomalous.</li>
<li><code>Fingerprinters</code> -- List of fingperprinters to be used by the detector.</li>
</ol>

            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../fingerprints" class="btn btn-neutral float-right" title="Fingerprints"/>Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../configuration/alerts" class="btn btn-neutral" title="Alerts"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
    <!-- Copyright etc -->
    </p>
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
        
            <a class="icon icon-github" style="float: left; color: #fcfcfc" href="https://github.com/nathanielc/morgoth/"> GitHub</a>
        
      <span><a href="../../configuration/alerts" style="color: #fcfcfc;">&laquo; Previous</a></span>
      <span style="margin-left: 15px"><a href="../fingerprints" style="color: #fcfcfc">Next &raquo;</a></span>
    </span>
</div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-59162957-1', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>